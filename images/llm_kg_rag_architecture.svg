<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 650">
  <defs>
    <style>
      .title { font: bold 24px sans-serif; fill: #2c3e50; }
      .subtitle { font: 18px sans-serif; fill: #34495e; }
      .text { font: 14px sans-serif; fill: #2c3e50; }
      .label { font: bold 12px sans-serif; fill: #ffffff; }
      .box { fill: #3498db; stroke: #2c3e50; stroke-width: 2; }
      .kg-box { fill: #e74c3c; stroke: #2c3e50; stroke-width: 2; }
      .rag-box { fill: #9b59b6; stroke: #2c3e50; stroke-width: 2; }
      .data-box { fill: #95a5a6; stroke: #2c3e50; stroke-width: 2; }
      .output-box { fill: #27ae60; stroke: #2c3e50; stroke-width: 2; }
      .kb-box { fill: #f39c12; stroke: #2c3e50; stroke-width: 2; }
      .arrow { fill: none; stroke: #2c3e50; stroke-width: 2; marker-end: url(#arrowhead); }
      .phase-label { font: bold 16px sans-serif; fill: #16a085; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#2c3e50" />
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="450" y="30" text-anchor="middle" class="title">LLM+KG+RAG 架构</text>
  <text x="450" y="55" text-anchor="middle" class="subtitle">知识图谱增强 + 检索增强生成组合模型</text>
  
  <!-- Training Phase -->
  <text x="50" y="110" class="phase-label">训练阶段</text>
  <line x1="50" y1="115" x2="850" y2="115" stroke="#16a085" stroke-width="1" stroke-dasharray="5,5"/>
  
  <!-- Original Data -->
  <rect x="80" y="140" width="150" height="80" class="data-box" rx="5"/>
  <text x="155" y="170" text-anchor="middle" class="label">原始训练数据</text>
  <text x="155" y="190" text-anchor="middle" class="label">(QA Pairs)</text>
  
  <!-- Arrow 1 -->
  <path d="M 230 180 L 290 180" class="arrow"/>
  
  <!-- Knowledge Graph Enhancement -->
  <rect x="290" y="140" width="150" height="80" class="kg-box" rx="5"/>
  <text x="365" y="170" text-anchor="middle" class="label">知识图谱</text>
  <text x="365" y="190" text-anchor="middle" class="label">增强处理</text>
  <text x="365" y="210" text-anchor="middle" class="label" style="font-size: 10px;">(Entity + Relation)</text>
  
  <!-- Arrow 2 -->
  <path d="M 440 180 L 500 180" class="arrow"/>
  
  <!-- Enhanced Training Data -->
  <rect x="500" y="140" width="150" height="80" class="data-box" rx="5"/>
  <text x="575" y="170" text-anchor="middle" class="label">KG增强</text>
  <text x="575" y="190" text-anchor="middle" class="label">训练数据</text>
  
  <!-- Arrow 3 -->
  <path d="M 650 180 L 700 180 L 700 260 L 520 260" class="arrow"/>
  
  <!-- LLM Model (Training) -->
  <rect x="370" y="230" width="150" height="80" class="box" rx="5"/>
  <text x="445" y="260" text-anchor="middle" class="label">MiniMind</text>
  <text x="445" y="280" text-anchor="middle" class="label">LLM 模型</text>
  <text x="445" y="300" text-anchor="middle" class="label" style="font-size: 10px;">(KG增强训练)</text>
  
  <!-- Inference Phase -->
  <text x="50" y="360" class="phase-label">推理阶段</text>
  <line x1="50" y1="365" x2="850" y2="365" stroke="#16a085" stroke-width="1" stroke-dasharray="5,5"/>
  
  <!-- Knowledge Base -->
  <rect x="50" y="390" width="150" height="80" class="kb-box" rx="5"/>
  <text x="125" y="415" text-anchor="middle" class="label">知识库</text>
  <text x="125" y="435" text-anchor="middle" class="label">(AviationQA)</text>
  <text x="125" y="455" text-anchor="middle" class="label" style="font-size: 10px;">(108万条QA)</text>
  
  <!-- User Input -->
  <rect x="250" y="390" width="150" height="80" class="data-box" rx="5"/>
  <text x="325" y="420" text-anchor="middle" class="label">用户输入</text>
  <text x="325" y="440" text-anchor="middle" class="label">(Query)</text>
  
  <!-- Arrow from Query to RAG -->
  <path d="M 325 470 L 325 510" class="arrow"/>
  
  <!-- Arrow from KB to RAG -->
  <path d="M 125 470 L 125 510 L 240 510" class="arrow"/>
  
  <!-- RAG Retriever -->
  <rect x="240" y="510" width="170" height="100" class="rag-box" rx="5"/>
  <text x="325" y="535" text-anchor="middle" class="label">RAG 检索器</text>
  <text x="325" y="555" text-anchor="middle" class="label" style="font-size: 10px;">1. Embedding (OpenAI)</text>
  <text x="325" y="570" text-anchor="middle" class="label" style="font-size: 10px;">2. 相似度计算</text>
  <text x="325" y="585" text-anchor="middle" class="label" style="font-size: 10px;">3. Top-K检索</text>
  <text x="325" y="600" text-anchor="middle" class="label" style="font-size: 10px;">4. 上下文构建</text>
  
  <!-- Arrow from RAG to Augmented Prompt -->
  <path d="M 410 560 L 480 560" class="arrow"/>
  
  <!-- Augmented Prompt -->
  <rect x="480" y="520" width="150" height="80" class="data-box" rx="5"/>
  <text x="555" y="545" text-anchor="middle" class="label">增强后的</text>
  <text x="555" y="565" text-anchor="middle" class="label">Prompt</text>
  <text x="555" y="585" text-anchor="middle" class="label" style="font-size: 10px;">(Query + Context)</text>
  
  <!-- Arrow from Augmented Prompt to LLM -->
  <path d="M 630 560 L 690 560" class="arrow"/>
  
  <!-- LLM Model (Inference) -->
  <rect x="690" y="520" width="150" height="80" class="kg-box" rx="5"/>
  <text x="765" y="545" text-anchor="middle" class="label">KG增强的</text>
  <text x="765" y="565" text-anchor="middle" class="label">LLM模型</text>
  <text x="765" y="585" text-anchor="middle" class="label" style="font-size: 10px;">(推理)</text>
  
  <!-- Arrow from LLM to Output -->
  <path d="M 765 520 L 765 470" class="arrow"/>
  
  <!-- Output -->
  <rect x="690" y="390" width="150" height="80" class="output-box" rx="5"/>
  <text x="765" y="420" text-anchor="middle" class="label">模型输出</text>
  <text x="765" y="440" text-anchor="middle" class="label">(Answer)</text>
  
  <!-- Highlight boxes -->
  <rect x="280" y="135" width="170" height="90" fill="none" stroke="#e74c3c" stroke-width="3" stroke-dasharray="5,5" rx="5"/>
  <text x="365" y="130" text-anchor="middle" style="font: bold 11px sans-serif; fill: #e74c3c;">KG增强 (训练时)</text>
  
  <rect x="235" y="505" width="180" height="110" fill="none" stroke="#9b59b6" stroke-width="3" stroke-dasharray="5,5" rx="5"/>
  <text x="325" y="500" text-anchor="middle" style="font: bold 11px sans-serif; fill: #9b59b6;">RAG增强 (推理时)</text>
  
</svg>

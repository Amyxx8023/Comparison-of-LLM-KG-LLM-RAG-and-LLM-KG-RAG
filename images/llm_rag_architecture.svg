<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 550">
  <defs>
    <style>
      .title { font: bold 24px sans-serif; fill: #2c3e50; }
      .subtitle { font: 18px sans-serif; fill: #34495e; }
      .text { font: 14px sans-serif; fill: #2c3e50; }
      .label { font: bold 12px sans-serif; fill: #ffffff; }
      .box { fill: #3498db; stroke: #2c3e50; stroke-width: 2; }
      .rag-box { fill: #9b59b6; stroke: #2c3e50; stroke-width: 2; }
      .data-box { fill: #95a5a6; stroke: #2c3e50; stroke-width: 2; }
      .output-box { fill: #27ae60; stroke: #2c3e50; stroke-width: 2; }
      .kb-box { fill: #f39c12; stroke: #2c3e50; stroke-width: 2; }
      .arrow { fill: none; stroke: #2c3e50; stroke-width: 2; marker-end: url(#arrowhead); }
      .phase-label { font: bold 16px sans-serif; fill: #9b59b6; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#2c3e50" />
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="450" y="30" text-anchor="middle" class="title">LLM+RAG 架构</text>
  <text x="450" y="55" text-anchor="middle" class="subtitle">检索增强生成模型</text>
  
  <!-- Training Phase -->
  <text x="50" y="110" class="phase-label">训练阶段</text>
  <line x1="50" y1="115" x2="850" y2="115" stroke="#9b59b6" stroke-width="1" stroke-dasharray="5,5"/>
  
  <!-- Original Data -->
  <rect x="250" y="140" width="150" height="80" class="data-box" rx="5"/>
  <text x="325" y="170" text-anchor="middle" class="label">原始训练数据</text>
  <text x="325" y="190" text-anchor="middle" class="label">(QA Pairs)</text>
  
  <!-- Arrow 1 -->
  <path d="M 400 180 L 470 180" class="arrow"/>
  
  <!-- LLM Model (Training) -->
  <rect x="470" y="140" width="150" height="80" class="box" rx="5"/>
  <text x="545" y="170" text-anchor="middle" class="label">MiniMind</text>
  <text x="545" y="190" text-anchor="middle" class="label">LLM 模型</text>
  <text x="545" y="210" text-anchor="middle" class="label" style="font-size: 10px;">(标准训练)</text>
  
  <!-- Inference Phase -->
  <text x="50" y="270" class="phase-label">推理阶段</text>
  <line x1="50" y1="275" x2="850" y2="275" stroke="#9b59b6" stroke-width="1" stroke-dasharray="5,5"/>
  
  <!-- Knowledge Base -->
  <rect x="50" y="300" width="150" height="80" class="kb-box" rx="5"/>
  <text x="125" y="325" text-anchor="middle" class="label">知识库</text>
  <text x="125" y="345" text-anchor="middle" class="label">(AviationQA)</text>
  <text x="125" y="365" text-anchor="middle" class="label" style="font-size: 10px;">(108万条QA)</text>
  
  <!-- User Input -->
  <rect x="250" y="300" width="150" height="80" class="data-box" rx="5"/>
  <text x="325" y="330" text-anchor="middle" class="label">用户输入</text>
  <text x="325" y="350" text-anchor="middle" class="label">(Query)</text>
  
  <!-- Arrow from Query to RAG -->
  <path d="M 325 380 L 325 420" class="arrow"/>
  
  <!-- Arrow from KB to RAG -->
  <path d="M 125 380 L 125 420 L 240 420" class="arrow"/>
  
  <!-- RAG Retriever -->
  <rect x="240" y="420" width="170" height="100" class="rag-box" rx="5"/>
  <text x="325" y="445" text-anchor="middle" class="label">RAG 检索器</text>
  <text x="325" y="465" text-anchor="middle" class="label" style="font-size: 10px;">1. Embedding (OpenAI)</text>
  <text x="325" y="480" text-anchor="middle" class="label" style="font-size: 10px;">2. 相似度计算</text>
  <text x="325" y="495" text-anchor="middle" class="label" style="font-size: 10px;">3. Top-K检索</text>
  <text x="325" y="510" text-anchor="middle" class="label" style="font-size: 10px;">4. 上下文构建</text>
  
  <!-- Arrow from RAG to Augmented Prompt -->
  <path d="M 410 470 L 480 470" class="arrow"/>
  
  <!-- Augmented Prompt -->
  <rect x="480" y="430" width="150" height="80" class="data-box" rx="5"/>
  <text x="555" y="455" text-anchor="middle" class="label">增强后的</text>
  <text x="555" y="475" text-anchor="middle" class="label">Prompt</text>
  <text x="555" y="495" text-anchor="middle" class="label" style="font-size: 10px;">(Query + Context)</text>
  
  <!-- Arrow from Augmented Prompt to LLM -->
  <path d="M 630 470 L 690 470" class="arrow"/>
  
  <!-- LLM Model (Inference) -->
  <rect x="690" y="430" width="150" height="80" class="box" rx="5"/>
  <text x="765" y="460" text-anchor="middle" class="label">LLM模型</text>
  <text x="765" y="480" text-anchor="middle" class="label">(推理)</text>
  
  <!-- Arrow from LLM to Output -->
  <path d="M 765 510 L 765 545" class="arrow"/>
  
  <!-- Output -->
  <rect x="690" y="545" width="150" height="0" class="output-box" rx="5"/>
  <rect x="690" y="420" width="150" height="0" class="output-box" rx="5"/>
  
  <!-- Move output down -->
  <rect x="690" y="310" width="150" height="60" class="output-box" rx="5"/>
  <text x="765" y="335" text-anchor="middle" class="label">模型输出</text>
  <text x="765" y="355" text-anchor="middle" class="label">(Answer)</text>
  
  <!-- Arrow from LLM inference to output -->
  <path d="M 765 430 L 765 370" class="arrow"/>
  
</svg>
